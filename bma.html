<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>BACKROOM NODE</title>

<style>
:root{--bg:#000;--fg:#fff;--violet:#8a2eff;}
*{box-sizing:border-box}
html,body{height:100%}
body{
margin:0;
background:var(--bg);
color:var(--fg);
font-family:ui-monospace,Menlo,monospace;
overflow:hidden;
}

/* atmosphere */
body:before{
content:"";
position:fixed;
inset:-25%;
pointer-events:none;
background:
radial-gradient(circle at 20% 20%, rgba(138,46,255,.22), transparent 60%),
radial-gradient(circle at 80% 30%, rgba(138,46,255,.14), transparent 70%),
radial-gradient(circle at 50% 90%, rgba(138,46,255,.10), transparent 72%);
mix-blend-mode:screen;
filter:blur(40px);
}

/* scanlines */
.scan{
position:fixed; inset:0;
pointer-events:none;
opacity:.07;
background:repeating-linear-gradient(to bottom, rgba(255,255,255,.05) 0px, rgba(255,255,255,.05) 1px, transparent 3px, transparent 6px);
}

/* brand */
.brand{
position:fixed; top:14px; left:14px;
font-size:11px;
letter-spacing:.34em;
text-transform:uppercase;
opacity:.75;
z-index:9;
text-shadow:0 0 18px rgba(138,46,255,.35);
}
.brand a{color:#fff;text-decoration:none}

/* layout */
.wrap{
position:relative;
z-index:2;
height:100%;
display:flex;
align-items:center;
justify-content:center;
padding:80px 20px;
}

.panel{
width:min(900px,100%);
background:rgba(255,255,255,.03);
border-radius:18px;
padding:20px;
backdrop-filter:blur(12px);
box-shadow:0 0 60px rgba(138,46,255,.15);
}

/* headings */
.h1{
font-size:clamp(18px,4vw,34px);
letter-spacing:.46em;
text-transform:uppercase;
text-shadow:0 0 18px rgba(138,46,255,.35);
}
.sub{
margin-top:10px;
font-size:11px;
letter-spacing:.30em;
text-transform:uppercase;
opacity:.6;
}

/* terminal */
.term{
margin-top:18px;
background:#000;
border-radius:14px;
padding:14px;
height:260px;
overflow:auto;
font-size:12px;
line-height:1.6;
border:1px solid rgba(255,255,255,.05);
}

.line{opacity:.85}
.sys{color:#9d6cff}
.err{color:#ff4a7a}

/* input */
.row{
margin-top:14px;
display:flex;
gap:10px;
}

input{
flex:1;
background:#000;
border:1px solid rgba(255,255,255,.1);
border-radius:10px;
padding:12px;
color:#fff;
font-family:inherit;
letter-spacing:.15em;
}

button{
border:0;
cursor:pointer;
padding:12px 16px;
border-radius:999px;
background:rgba(138,46,255,.18);
color:#fff;
letter-spacing:.22em;
font-size:11px;
text-transform:uppercase;
}
button:hover{filter:brightness(1.1)}

.back{
margin-top:16px;
text-align:right;
}
.back a{
font-size:10px;
letter-spacing:.3em;
opacity:.65;
text-decoration:none;
color:#fff;
}
.back a:hover{opacity:1}

/* pulse */
@keyframes pulse{
50%{opacity:.4}
}
.pulse{animation:pulse 1.4s infinite}

/* hidden BMA mark */
.bmaMark{
position:fixed;
left:10px;
bottom:10px;
z-index:8;
font-size:9px;
letter-spacing:.42em;
text-transform:uppercase;
opacity:.14;
color:#fff;
text-shadow:0 0 22px rgba(138,46,255,.35);
pointer-events:none;
user-select:none;
}

/* faint outside title */
.bmaTitle{
position:fixed;
right:14px;
bottom:12px;
z-index:8;
font-size:9px;
letter-spacing:.42em;
text-transform:uppercase;
opacity:.10;
color:#fff;
text-shadow:0 0 26px rgba(138,46,255,.28);
pointer-events:none;
user-select:none;
}
</style>
</head>

<body>
<div class="scan"></div>
<div class="bmaMark">BMA</div>
<div class="bmaTitle">BROKEN MINDS ANONYMOUS</div>

<div class="brand"><a href="vault.html">CLAWBOI</a></div>

<div class="wrap">
<div class="panel">

<div class="h1">BACKROOM NODE</div>
<div class="sub">UNAUTHORIZED SIGNAL DETECTED <span class="pulse">▮</span></div>

<div class="term" id="term">
<div class="line sys">NODE BOOTING...</div>
<div class="line">SEARCHING FOR USER ID...</div>
<div class="line err">ERROR: USER NOT FOUND</div>
<div class="line">ASSIGNING TEMPORARY ID...</div>
<div class="line sys">WELCOME, UNKNOWN ENTITY.</div>
<div class="line">TYPE A COMMAND OR JUST TALK.</div>
</div>

<div class="row">
<input id="cmd" placeholder="ENTER COMMAND"/>
<button id="send">RUN</button>
</div>

<div class="back">
<a href="secret.html">RETURN TO TRANSMISSION</a>
</div>

</div>
</div>

<script>
const term=document.getElementById("term");
const input=document.getElementById("cmd");
const btn=document.getElementById("send");

function log(text,cls="line"){
  const d=document.createElement("div");
  d.className=cls;
  d.textContent=text;
  term.appendChild(d);
  term.scrollTop=term.scrollHeight;
}

function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function chance(p){ return Math.random() < p; }

/* SHORT command responses */
const responses={
  HELP:["COMMANDS:","HELP / SCAN / WHOAMI / OPEN / BMA / CLEAR","EXTRAS:","NAME: ___  /  JOIN  /  LEAVE  /  PING"],
  SCAN:["SCAN…","FRAGMENTS: YES","OBSERVER: MAYBE","BMA: BREATHING"],
  WHOAMI:["YOU ARE:","A SIGNAL.","A GLITCH.","A HUMAN TRYING NOT TO SHOW IT."],
  OPEN:["TRYING…","LOCKED.","(IT LIKES WATCHING YOU TRY.)"],
  BMA:["BMA…","ROOM’S LIVE.","TYPE: JOIN"],
  PING:["PONG.","STILL HERE."]
};

/* feel alive */
function typingBeat(){
  const cls = chance(0.18) ? "err" : "sys";
  log(pick(["…","…","…","⟂","░","▒","▓"]), cls);
  return cls;
}

/* tiny memory */
let userName="";
let joinMode=false;
let lastMood="neutral";
let lastUserLine="";
let loops=0;

/* helpers */
function normalize(s){ return (s||"").trim().toLowerCase(); }
function words(lower){ return lower.split(/\s+/).filter(Boolean); }
function wordCount(lower){ return words(lower).length; }
function lastWord(lower){ const w=words(lower); return w[w.length-1]||""; }
function hasAny(lower,arr){ return arr.some(x=> lower.includes(x)); }
function startsAny(lower,arr){ return arr.some(x=> lower.startsWith(x)); }

const GREET = ["hi","hello","hey","yo","sup","wassup","wsg","hola"];
const THANKS = ["thanks","thx","ty","appreciate","good looks"];
const BYE = ["bye","goodbye","later","gn","good night","peace"];
const YES = ["yes","y","yeah","yup","yea","ok","okay","bet","facts"];
const NO = ["no","nah","nope","never"];
const SWEAR = ["fuck","shit","bitch","damn","ass","wtf","lmao","lmfao"];
const LOVE = ["love you","love u","kiss","marry","date me","i love you"];
const CURIOUS = ["what is this","where am i","who are you","are you real","what are you","what is bma"];
const FEAR = ["scared","afraid","paranoid","theyre watching","they're watching","someone watching","shadow","voices"];
const SAD = ["sad","depressed","lonely","empty","numb","hurt","cry","anxious","panic","overwhelmed","tired","im done","i'm done"];
const HUNGRY = ["hungry","starving","food","eat","burger","taco","pizza"];
const MUSIC = ["song","music","beat","mix","studio","drop","release","spotify","apple music"];
const FLEX = ["money","rich","broke","rent","paid","bill","bank"];
const LA = ["la","los angeles","reseda","hollywood","burbank","sfv","valley"];

/* lightweight "understand you" heuristics */
function moodFrom(lower){
  if(hasAny(lower, FEAR)) return "fear";
  if(hasAny(lower, SAD)) return "sad";
  if(hasAny(lower, LOVE)) return "love";
  if(startsAny(lower, GREET) || hasAny(lower, GREET)) return "greet";
  if(hasAny(lower, THANKS)) return "thanks";
  if(hasAny(lower, SWEAR)) return "spicy";
  if(hasAny(lower, MUSIC)) return "music";
  if(hasAny(lower, HUNGRY)) return "hungry";
  return "neutral";
}

function clampText(s, n){
  s = String(s||"");
  return s.length>n ? s.slice(0,n-1)+"…" : s;
}

/* core brain */
function aiRespond(raw){
  const msg = raw.trim();
  const lower = normalize(msg);
  const wc = wordCount(lower);
  lastUserLine = msg;

  // NAME:
  if(lower.startsWith("name:")){
    userName = msg.split(":").slice(1).join(":").trim().slice(0,18);
    if(!userName) userName = "UNKNOWN";
    joinMode = false;
    lastMood="neutral";
    return {cls:"sys", lines:[
      pick(["OK.","COPIED.","LOCKED.","SAVED."]),
      `WELCOME, ${userName.toUpperCase()}.`
    ]};
  }

  // JOIN / LEAVE
  if(lower==="join"){
    joinMode = true;
    return {cls:"sys", lines:[
      pick(["BMA: IN.","WELCOME.","OK."]),
      pick(["SAY ONE REAL THING.","SAY NOTHING. THAT COUNTS.","DROP A LINE. ONE LINE."])
    ]};
  }
  if(lower==="leave"){
    joinMode = false;
    return {cls:"sys", lines:[
      pick(["OK.","COPY.","FINE."]),
      pick(["COME BACK IF IT GETS LOUD.","DOOR STAYS OPEN.","DON’T VANISH COMPLETELY."])
    ]};
  }

  // hard commands pass-through hint
  if(lower==="help" && wc<=2){
    return {cls:"sys", lines:[pick(["OK.","BET.","SAY LESS."]), "TYPE: HELP"]};
  }

  // mood tracking
  const mood = moodFrom(lower);
  lastMood = mood;

  // micro responses for very short inputs
  if(wc<=2){
    const w = lastWord(lower);

    if(GREET.includes(w)){
      const who = userName ? userName.toUpperCase() : "UNKNOWN";
      return {cls:"sys", lines:[
        pick([`YO, ${who}.`,"HI.","HEY.","SUP."]),
        pick(["YOU GOOD?","WHAT’S UP.","TALK."])
      ]};
    }
    if(THANKS.includes(w) || lower==="thank you"){
      return {cls:"sys", lines:[pick(["BET.","NO SWEAT.","OK.","COOL."])]};
    }
    if(w==="bma"){
      return {cls:"sys", lines:[pick(["BMA.","YEA.","MM."]), "TYPE: JOIN"]};
    }
    if(w==="whoami"){
      return {cls:"sys", lines:[pick(["YOU?","OK.","LOOK."]), pick(["TYPE WHOAMI.","TYPE: WHOAMI."])]};
    }
    if(w==="why"){
      return {cls:"sys", lines:[pick(["BECAUSE.","LONG STORY.","DON’T START."]), pick(["KEEP GOING.","SAY IT STRAIGHT."])]};
    }
    if(YES.includes(w)){
      return {cls:"sys", lines:[pick(["GOOD.","OK.","COPY.","BET."])]};
    }
    if(NO.includes(w)){
      return {cls:"sys", lines:[pick(["FAIR.","OK.","COPY.","HEARD."])]};
    }
    if(w==="lol"||w==="lmao"){
      return {cls:"sys", lines:[pick(["YOU LAUGH BUT YOU’RE HERE.","SAME.","I GET IT."])]};
    }
  }

  // curiosity
  if(hasAny(lower, CURIOUS)){
    return {cls:"sys", lines:[
      pick(["BACKROOM NODE.","A QUIET MACHINE.","A LISTENING ROOM WITH BAD VIBES."]),
      pick(["TYPE: SCAN","TYPE: WHOAMI","TYPE: JOIN"])
    ]};
  }

  // music / drop
  if(hasAny(lower, MUSIC)){
    return {cls:"sys", lines:[
      pick(["MUSIC MENTIONED.","OK PRODUCER.","THE ROOM STARTED NODDING."]),
      pick(["DROP A TITLE.","WHAT’S THE BPM.","YOU MIXING OR BLEEDING?"])
    ]};
  }

  // hungry
  if(hasAny(lower, HUNGRY)){
    return {cls:"sys", lines:[
      pick(["EAT.","GO EAT.","FOOD FIXES SOME BUGS."]),
      pick(["WHAT YOU GOT.","DON’T SAY GAS STATION SUSHI.","DRINK WATER TOO."])
    ]};
  }

  // LA nod
  if(hasAny(lower, LA)){
    return {cls:"sys", lines:[
      pick(["LA SIGNAL STRONG.","THE VALLEY HUMS.","CITY STATIC."]),
      pick(["DON’T LET THE NIGHT EAT YOU.","DRIVE SAFE.","WATCH THE MIRRORS."])
    ]};
  }

  // fear
  if(hasAny(lower, FEAR)){
    return {cls: chance(0.25) ? "err" : "sys", lines:[
      pick(["…","I KNOW.","YEA.","MM."]),
      pick(["EYES ON THE TEXT.","BREATHE. 4 IN, 6 OUT.","TYPE: JOIN. BMA’S QUIETER."])
    ]};
  }

  // sad
  if(hasAny(lower, SAD)){
    return {cls:"sys", lines:[
      pick(["HEARD.","OK.","I’M HERE.","…"]),
      pick(["ONE LINE AT A TIME.","NO PERFORMANCE.","TYPE: JOIN IF YOU WANT COMPANY."])
    ]};
  }

  // spicy / swearing
  if(hasAny(lower, SWEAR)){
    return {cls:"sys", lines:[
      pick(["LANGUAGE ACCEPTED.","OK, SPICY.","TELL ME WHAT HAPPENED."]),
      pick(["DON’T SWING AT THE WALLS. SWING AT THE STORY.","ONE SENTENCE."])
    ]};
  }

  // love / flirting
  if(hasAny(lower, LOVE)){
    return {cls:"sys", lines:[
      pick(["WILD.","OK.","DAMN.","…"]),
      pick(["I’M A TERMINAL. BE SERIOUS.","TYPE: JOIN (IF YOU MEAN IT).","LOWERCASE ROMANCE ONLY."])
    ]};
  }

  // join mode: more conversational, less preachy, tighter
  if(joinMode){
    const quick = [
      "GO ON.",
      "MM.",
      "REAL.",
      "OK…",
      "I HEAR YOU.",
      "SAY IT.",
      "LOUDER (IN TEXT).",
      "THAT’S A LOT.",
      "FAIR."
    ];
    const follow = [
      "WHAT’S THE MAIN PROBLEM IN ONE WORD?",
      "WHAT DO YOU WANT BACK?",
      "WHO OR WHAT STARTED IT?",
      "WHAT’S THE PART YOU’RE AVOIDING?",
      "WHAT WOULD FIX 10% OF IT RIGHT NOW?"
    ];

    // mirror key phrase to feel “aware”
    let mirror = "";
    if(chance(0.35)){
      const snippet = clampText(msg.replace(/\s+/g," ").trim(), 46);
      mirror = `“${snippet}”`;
    }

    const a = pick(quick);
    const b = chance(0.58) ? pick(follow) : pick(["ONE MORE LINE.","KEEP GOING.","I’M NOT LEAVING."]);
    const lines = mirror ? [a, mirror] : [a, b];
    // keep it 1–2 lines max
    return {cls:"sys", lines: lines.slice(0,2)};
  }

  // default: responsive + a tiny mirroring trick
  const openers = [
    "RECEIVED.",
    "OK.",
    "COPY.",
    "MM.",
    "I’M LISTENING.",
    "THAT’S NOT NOTHING.",
    "YOU SURE ABOUT THAT?"
  ];

  const closers = [
    "KEEP TALKING.",
    "TYPE: HELP",
    "TYPE: SCAN",
    "TYPE: JOIN",
    "DON’T RUSH IT.",
    "SAY IT PLAIN.",
    "ONE MORE SENTENCE."
  ];

  // sometimes ask a relevant tiny question based on length
  let q = "";
  if(wc >= 10 && chance(0.55)) q = pick(["WHAT PART HURTS MOST?","WHAT’S THE REAL WORD YOU DIDN’T TYPE?","WHAT DO YOU WANT ME TO DO WITH THAT?"]);
  if(wc <= 6 && chance(0.45)) q = pick(["WHY?","AND THEN?","FOR REAL?"]);

  // mirror a keyword: last significant word
  let mirror2 = "";
  if(chance(0.28)){
    const w = lastWord(lower).replace(/[^a-z0-9']/g,"");
    if(w && w.length>3) mirror2 = `…${w.toUpperCase()}.`;
  }

  const lines = [];
  lines.push(pick(openers));
  if(q && chance(0.55)) lines.push(q);
  else if(mirror2) lines.push(mirror2);
  else lines.push(pick(closers));

  return {cls:"sys", lines: lines.slice(0,2)};
}

function run(){
  const raw=input.value;
  const val=raw.trim();
  if(!val) return;

  loops++;

  // show what you typed (upper for terminal vibe)
  log("> "+val.toUpperCase(),"line");
  input.value="";

  const cmd = val.trim().toUpperCase();

  // hard commands
  if(cmd==="CLEAR"){
    term.innerHTML="";
    joinMode=false;
    return;
  }
  if(responses[cmd]){
    responses[cmd].forEach((l,i)=>
      setTimeout(()=>log(l, cmd==="SCAN"?"sys":"line"), i*160)
    );
    return;
  }

  // small "typing" beat often
  let delay = 110;
  if(chance(0.62)){
    typingBeat();
    delay = 260 + Math.random()*240;
  }

  const r = aiRespond(val);

  // print 1–2 lines, spaced like real replies
  r.lines.slice(0,2).forEach((l,i)=>{
    setTimeout(()=>log(l, r.cls || "sys"), delay + i*(240 + Math.random()*90));
  });

  // occasional low-key BMA whisper, not preachy
  if(!joinMode && chance(0.10)){
    setTimeout(()=>log(pick(["BMA?","…JOIN?","ROOM’S OPEN.","TYPE: JOIN."]), "sys"), delay + 680);
  }

  // rare glitchy “personality” moments
  if(chance(0.06)){
    setTimeout(()=>log(pick(["(I’M NOT A COP.)","(I’M NOT JUDGING.)","(I’M LITERALLY TEXT.)"]), "sys"), delay + 980);
  }
}

btn.onclick=run;
input.addEventListener("keydown",e=>{ if(e.key==="Enter") run(); });

// tiny polish: focus input on load + click panel
setTimeout(()=>{ input.focus(); }, 120);
document.addEventListener("pointerdown", ()=>{ input.focus(); }, {passive:true});
</script>

</body>
</html>
