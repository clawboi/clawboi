<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DREAM</title>

<style>
body{
margin:0;
background:#000;
overflow:hidden;
font-family:monospace;
color:white;
}
canvas{display:block}

#ui{
position:fixed;
top:12px;
left:50%;
transform:translateX(-50%);
letter-spacing:.2em;
font-size:14px;
text-align:center;
opacity:.9;
}

#nameBox{
position:fixed;
inset:0;
display:flex;
align-items:center;
justify-content:center;
flex-direction:column;
gap:18px;
background:#000;
z-index:10;
}

input{
background:#000;
border:1px solid white;
color:white;
padding:12px;
font-family:monospace;
letter-spacing:.2em;
text-align:center;
}

button{
background:#fff;
color:#000;
border:0;
padding:12px 18px;
cursor:pointer;
letter-spacing:.2em;
}
</style>
</head>
<body>

<div id="nameBox">
<div>ENTER NAME</div>
<input id="nameInput" maxlength="12" placeholder="PLAYER">
<button onclick="startGame()">START</button>
</div>

<div id="ui"></div>
<canvas id="game"></canvas>

<script>
const c=document.getElementById("game");
const ctx=c.getContext("2d");

function resize(){c.width=innerWidth;c.height=innerHeight}
resize();addEventListener("resize",resize);

/* sound engine */
const beep=()=>{let a=new AudioContext();let o=a.createOscillator();let g=a.createGain();o.connect(g);g.connect(a.destination);o.type="square";o.frequency.value=200+Math.random()*400;g.gain.value=.05;o.start();o.stop(a.currentTime+.08)}

/* player */
const player={x:c.width/2,y:c.height-120,size:40,fat:0}

/* controls */
let mx=player.x;
addEventListener("mousemove",e=>mx=e.clientX);
addEventListener("touchmove",e=>mx=e.touches[0].clientX,{passive:true});

/* storage */
let bestScore=localStorage.getItem("clawboiHigh")||0;
let bestName=localStorage.getItem("clawboiName")||"NONE";
let playerName="";

/* gameplay */
let pills=[];
let particles=[];
let score=0;
let combo=0;
let spawnRate=90;
let tick=0;
let speed=2;
let exploded=false;
let boom=0;
let running=false;
let boss=null;

/* start */
function startGame(){
playerName=document.getElementById("nameInput").value||"PLAYER";
document.getElementById("nameBox").style.display="none";
running=true;
loop();
}

/* spawn pills */
function spawn(){
pills.push({
x:Math.random()*c.width,
y:-20,
r:12+Math.random()*12,
v:speed+Math.random()*2,
h:Math.random()*360
});
}

/* boss */
function spawnBoss(){
boss={x:c.width/2,y:-150,r:120,hp:20}
}

/* particles */
function burst(x,y,color){
for(let i=0;i<12;i++){
particles.push({
x,y,
vx:(Math.random()-.5)*6,
vy:(Math.random()-.5)*6,
life:40,
color
})
}
}

/* restart */
addEventListener("click",()=>{if(exploded)location.reload()});

/* loop */
function loop(){
if(!running)return;
ctx.clearRect(0,0,c.width,c.height);

tick++;

/* spawn logic */
if(!boss && tick%spawnRate===0)spawn();
if(tick%900===0 && !boss)spawnBoss();

/* difficulty */
if(tick%600===0){
speed+=.3;
if(spawnRate>25)spawnRate-=4;
}

/* pills */
for(let i=pills.length-1;i>=0;i--){
let p=pills[i];
p.y+=p.v;

ctx.fillStyle=`hsl(${p.h},90%,60%)`;
ctx.beginPath();
ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
ctx.fill();

/* collision */
let dx=p.x-player.x;
let dy=p.y-player.y;
let dist=Math.hypot(dx,dy);

/* near miss slowmo */
if(dist<p.r+player.size+40 && dist>p.r+player.size){
combo++;
score+=combo;
}

/* eat */
if(dist<p.r+player.size){
pills.splice(i,1);
player.fat+=6;
combo=0;
beep();
burst(p.x,p.y,"white");
}

/* remove */
if(p.y>c.height+40)pills.splice(i,1);
}

/* boss logic */
if(boss){
boss.y+=1.2;
ctx.strokeStyle="#8a2eff";
ctx.lineWidth=6;
ctx.beginPath();
ctx.arc(boss.x,boss.y,boss.r,0,Math.PI*2);
ctx.stroke();

ctx.fillStyle="#8a2eff";
ctx.fillRect(boss.x-60,boss.y-10,120,20);

if(Math.abs(player.x-boss.x)<boss.r){
boss.hp--;
burst(player.x,player.y,"#8a2eff");
}

if(boss.hp<=0){
score+=1000;
burst(boss.x,boss.y,"#8a2eff");
boss=null;
}
}

/* movement */
player.x+=(mx-player.x)*.2;

/* draw player */
ctx.save();
ctx.translate(player.x,player.y);

let s=player.size+player.fat;

ctx.fillStyle="#fff";
ctx.fillRect(-s,-s,s*2,s*2);

ctx.fillStyle="#000";
ctx.fillRect(-s/2,-s/2,8,8);
ctx.fillRect(s/2-8,-s/2,8,8);
ctx.fillRect(-s/4,s/4,s/2,8);

ctx.restore();

/* particles */
for(let i=particles.length-1;i>=0;i--){
let p=particles[i];
p.x+=p.vx;
p.y+=p.vy;
p.life--;
ctx.fillStyle=p.color;
ctx.fillRect(p.x,p.y,4,4);
if(p.life<=0)particles.splice(i,1);
}

/* explosion */
if(player.fat>150&&!exploded){
exploded=true;
if(score>bestScore){
bestScore=score;
bestName=playerName;
localStorage.setItem("clawboiHigh",bestScore);
localStorage.setItem("clawboiName",bestName);
}
}

if(exploded){
boom+=8;

ctx.fillStyle="rgba(255,255,255,.15)";
ctx.beginPath();
ctx.arc(player.x,player.y,boom,0,Math.PI*2);
ctx.fill();

ctx.fillStyle="#fff";
ctx.font="bold 38px monospace";
ctx.textAlign="center";
ctx.fillText("OVERDOSE",c.width/2,c.height/2-60);

ctx.font="18px monospace";
ctx.fillText("SCORE "+score,c.width/2,c.height/2);

if(score>5000){
ctx.fillStyle="#8a2eff";
ctx.fillText("SECRET ENDING UNLOCKED",c.width/2,c.height/2+60);
}

ctx.fillText("BEST "+bestScore+" â€” "+bestName,c.width/2,c.height/2+100);
ctx.fillText("CLICK TO RESTART",c.width/2,c.height/2+150);
return;
}

/* score */
score++;
document.getElementById("ui").textContent=
playerName+" | "+score+" | combo "+combo+" | best "+bestScore;

requestAnimationFrame(loop);
}
</script>
</body>
</html>
