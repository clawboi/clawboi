<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>TRANSMISSION</title>

<style>
:root{
  --violet:#8a2eff;
  --bg:#000;
  --fg:#fff;
}

*{box-sizing:border-box}

html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--fg);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  overflow:hidden;
  position:relative;
}

/* VIOLET FOG */
body::before{
  content:"";
  position:fixed;
  inset:-25%;
  pointer-events:none;
  z-index:0;
  background:
    radial-gradient(circle at 18% 20%, rgba(138,46,255,.26), transparent 58%),
    radial-gradient(circle at 78% 32%, rgba(138,46,255,.18), transparent 64%),
    radial-gradient(circle at 48% 88%, rgba(138,46,255,.14), transparent 70%),
    radial-gradient(circle at 60% 60%, rgba(255,255,255,.04), transparent 72%);
  mix-blend-mode:screen;
  filter:blur(38px) saturate(1.25);
  animation:fog 18s ease-in-out infinite;
}
@keyframes fog{
  0%,100%{transform:translate(0,0) scale(1)}
  50%{transform:translate(-2.5%,3.5%) scale(1.02)}
}

/* CRT SCANLINES */
.scanlines{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:6;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,.06) 0px,
      rgba(255,255,255,.06) 1px,
      rgba(0,0,0,0) 3px,
      rgba(0,0,0,0) 6px
    );
  opacity:.08;
  mix-blend-mode:overlay;
}

/* SUBTLE CHROMA SPLIT */
.chroma{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:5;
  filter:contrast(1.08) saturate(1.05);
  animation:chroma 6s ease-in-out infinite;
}
@keyframes chroma{
  0%,100%{transform:translate(0,0)}
  50%{transform:translate(.6px,-.4px)}
}

/* CENTER WRAP */
.wrap{
  position:relative;
  z-index:2;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:24px;
}

.title{
  font-size:clamp(20px,4.2vw,52px);
  letter-spacing:.46em;
  text-transform:uppercase;
  text-shadow:
    0 0 18px rgba(138,46,255,.40),
    0 0 60px rgba(138,46,255,.18);
  user-select:none;
}

.sub{
  margin-top:10px;
  font-size:12px;
  letter-spacing:.28em;
  text-transform:uppercase;
  opacity:.6;
}

.timer{
  margin-top:26px;
  font-size:clamp(18px,3vw,40px);
  letter-spacing:.28em;
  text-transform:uppercase;
  text-shadow:0 0 18px rgba(138,46,255,.25);
}

/* SCRAMBLE LOOK */
.timer .ghost{
  opacity:.35;
  filter:blur(.4px);
}

/* WHISPER MESSAGE */
.whisper{
  margin-top:18px;
  font-size:11px;
  letter-spacing:.32em;
  text-transform:uppercase;
  opacity:0;
  transition:opacity .12s linear;
}
.whisper.on{ opacity:.55; }

/* SCREEN TEAR BARS */
.tear{
  position:fixed;
  left:-10%;
  width:120%;
  height:22px;
  background:linear-gradient(90deg,
    transparent,
    rgba(255,255,255,.12),
    rgba(138,46,255,.22),
    rgba(255,255,255,.10),
    transparent
  );
  opacity:0;
  z-index:8;
  mix-blend-mode:screen;
  filter:blur(.2px);
  transform:skewX(-18deg);
}

/* FLASH */
.flash{
  position:fixed;
  inset:0;
  background:#fff;
  opacity:0;
  pointer-events:none;
  z-index:10;
}
.flash.active{ animation:flash .14s; }
@keyframes flash{
  0%{opacity:0}
  50%{opacity:.35}
  100%{opacity:0}
}

/* CURSOR TRAIL */
.trail{
  position:fixed;
  width:10px;height:10px;
  border-radius:50%;
  background:rgba(138,46,255,.9);
  box-shadow:0 0 20px rgba(138,46,255,.4);
  pointer-events:none;
  z-index:9;
  opacity:.0;
  transform:translate(-50%,-50%);
}

/* SIGIL */
.sigil{
  position:fixed;
  right:18px;
  bottom:18px;
  width:44px;height:44px;
  border-radius:50%;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.03);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:7;
  cursor:pointer;
  user-select:none;
  text-shadow:0 0 14px rgba(138,46,255,.35);
  letter-spacing:.2em;
  font-size:10px;
  opacity:.65;
}
.sigil:hover{opacity:1}
.sigil span{display:block; transform:translateX(.8px)}
.sigil.spin{ animation:sigil 1.2s linear infinite; }
@keyframes sigil{
  to{ transform:rotate(360deg); }
}

/* TAP TO SYNC GATE */
.gate{
  position:fixed;
  inset:0;
  z-index:20;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.82);
  backdrop-filter:blur(10px);
}
.gateBtn{
  appearance:none;
  border:0;
  cursor:pointer;
  padding:14px 18px;
  border-radius:999px;
  background:#fff;
  color:#000;
  letter-spacing:.28em;
  font-size:12px;
  text-transform:uppercase;
}
.gateNote{
  margin-top:14px;
  font-size:11px;
  letter-spacing:.22em;
  text-transform:uppercase;
  opacity:.55;
  text-align:center;
  max-width:520px;
}

@media (prefers-reduced-motion: reduce){
  body::before,.chroma,.sigil.spin{animation:none!important}
}
</style>
</head>
<body>

<div class="scanlines"></div>
<div class="chroma"></div>
<div class="flash" id="flash"></div>
<div class="tear" id="tear"></div>
<div class="trail" id="trail"></div>

<div class="wrap">
  <div>
    <div class="title" id="title">TRANSMISSION INCOMING</div>
    <div class="sub" id="sub">SIGNAL: UNSTABLE · DO NOT LOOK AWAY</div>
    <div class="timer" id="timer">LOADING SIGNAL...</div>
    <div class="whisper" id="whisper">YOU HEAR IT TOO</div>
  </div>
</div>

<div class="sigil" id="sigil" title="sigil"><span>SIGIL</span></div>

<!-- Tap-to-sync gate for iOS audio -->
<div class="gate" id="gate">
  <div>
    <button class="gateBtn" id="syncBtn">TAP TO SYNC</button>
    <div class="gateNote">This unlocks the distortion + makes the page feel alive on iPhone.</div>
  </div>
</div>

<script>
/* ===== RELEASE DATE =====
   You said: "two weeks from now from the second"
   Your current page uses March 2, 2026 at midnight.
   Change it here anytime.
*/
const release = new Date("2026-03-02T00:00:00");

/* ===== UI ===== */
const timerEl = document.getElementById("timer");
const flash = document.getElementById("flash");
const tear  = document.getElementById("tear");
const whisper = document.getElementById("whisper");
const trail = document.getElementById("trail");
const sigil = document.getElementById("sigil");
const gate = document.getElementById("gate");
const syncBtn = document.getElementById("syncBtn");
const titleEl = document.getElementById("title");

let audioOn = false;
let ctx = null;

/* ===== HELPERS ===== */
const pad2 = (n)=> String(n).padStart(2,"0");
const rand = (a,b)=> a + Math.random()*(b-a);

function formatCountdown(ms){
  const d = Math.floor(ms/86400000);
  const h = Math.floor(ms%86400000/3600000);
  const m = Math.floor(ms%3600000/60000);
  const s = Math.floor(ms%60000/1000);
  return `${d}D ${pad2(h)}H ${pad2(m)}M ${pad2(s)}S`;
}

/* scramble characters */
const CHARS = "░▒▓█@#%&*+=-?/\\<>[]{}01ZXCVBNM";
function scrambleString(str, intensity=0.35){
  let out = "";
  for(let i=0;i<str.length;i++){
    const ch = str[i];
    if(ch === " ") { out += " "; continue; }
    if(Math.random() < intensity){
      out += CHARS[Math.floor(Math.random()*CHARS.length)];
    }else{
      out += ch;
    }
  }
  return out;
}

/* glitch flash + tear */
function hitGlitch(power=1){
  flash.classList.add("active");
  setTimeout(()=>flash.classList.remove("active"),120);

  const y = Math.floor(rand(10, 90));
  tear.style.top = y + "vh";
  tear.style.opacity = (0.10 + power*0.12).toFixed(2);
  tear.style.height = Math.floor(14 + power*18) + "px";
  tear.style.filter = `blur(${(0.1 + power*0.35).toFixed(2)}px)`;
  setTimeout(()=>{ tear.style.opacity = 0; }, 140);
}

/* ===== AUDIO GLITCH ===== */
function ensureAudio(){
  if(ctx) return;
  ctx = new (window.AudioContext || window.webkitAudioContext)();
}

function glitchPop(){
  if(!audioOn || !ctx) return;
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.type = "square";
  o.frequency.value = 40 + Math.random()*520;
  g.gain.value = 0.0001;
  o.connect(g);
  g.connect(ctx.destination);
  const t = ctx.currentTime;
  g.gain.setValueAtTime(0.0001, t);
  g.gain.exponentialRampToValueAtTime(0.06, t + 0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, t + 0.09);
  o.start(t);
  o.stop(t + 0.10);
}

function glitchSweep(){
  if(!audioOn || !ctx) return;
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.type = "sawtooth";
  o.frequency.setValueAtTime(180, ctx.currentTime);
  o.frequency.exponentialRampToValueAtTime(40, ctx.currentTime + 0.12);
  g.gain.value = 0.045;
  o.connect(g);
  g.connect(ctx.destination);
  o.start();
  setTimeout(()=>o.stop(), 140);
}

/* ===== COUNTDOWN LOOP (with scramble + ghost line) ===== */
function tick(){
  const now = new Date();
  const diff = release - now;

  if(diff <= 0){
    timerEl.textContent = "OUT NOW";
    // occasional celebration damage
    if(Math.random() < 0.25) hitGlitch(2.0);
    return;
  }

  const clean = formatCountdown(diff);

  // scramble for a few frames randomly
  const scrambleNow = Math.random() < 0.22;
  if(scrambleNow){
    const intensity = 0.28 + Math.random()*0.45;
    const scrambled = scrambleString(clean, intensity);
    timerEl.innerHTML = `<span class="ghost">${scrambled}</span>`;
    if(Math.random() < 0.35) hitGlitch(1.0);
    if(Math.random() < 0.40) glitchPop();
  }else{
    timerEl.textContent = clean;
  }

  // rare whisper flicker
  if(Math.random() < 0.07){
    whisper.classList.add("on");
    setTimeout(()=>whisper.classList.remove("on"), 90);
  }
}

/* ===== CURSOR TRAIL ===== */
let tx = window.innerWidth/2, ty = window.innerHeight/2;
document.addEventListener("pointermove", (e)=>{
  tx = e.clientX; ty = e.clientY;
  trail.style.left = tx + "px";
  trail.style.top  = ty + "px";
  trail.style.opacity = 0.9;
  clearTimeout(trail._t);
  trail._t = setTimeout(()=>trail.style.opacity = 0.0, 110);
}, {passive:true});

/* ===== SIGIL CLICK ===== */
sigil.addEventListener("click", ()=>{
  sigil.classList.add("spin");
  hitGlitch(2.2);
  glitchSweep();
  titleEl.style.filter = "brightness(1.35)";
  setTimeout(()=>{
    titleEl.style.filter = "";
    sigil.classList.remove("spin");
  }, 900);
});

/* ===== TAP TO SYNC (iOS unlock) ===== */
syncBtn.addEventListener("click", async ()=>{
  try{
    ensureAudio();
    await ctx.resume?.();
    audioOn = true;
    gate.style.display = "none";
    hitGlitch(1.8);
    glitchSweep();
    // kick off loops
    tick();
    setInterval(tick, 250);         // fast enough to feel “alive”
    setInterval(()=>{               // random extra damage
      if(Math.random() < 0.18) hitGlitch(1.2);
      if(Math.random() < 0.16) glitchPop();
    }, 700);
  }catch(e){
    // if something fails, still allow visual mode
    audioOn = false;
    gate.style.display = "none";
    tick();
    setInterval(tick, 300);
  }
});

</script>
</body>
</html>
