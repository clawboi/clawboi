<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>CLAWBOI ULTRA âˆž BUILD</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
html,body{margin:0;background:#05030a;overflow:hidden;font-family:monospace}
canvas{display:block;margin:auto;image-rendering:pixelated}
.nav{position:fixed;top:10px;left:14px;font-size:12px;letter-spacing:.25em}
.nav a{color:#fff;text-decoration:none;margin-right:18px;opacity:.7}
.nav a:hover{opacity:1}
</style>
</head>
<body>

<div class="nav">
<a href="index.html">CLAWBOI</a>
<a href="games.html">GAMES</a>
</div>

<canvas id="c" width="960" height="540"></canvas>

<script>
(()=>{

const canvas=c;
const ctx=canvas.getContext("2d");

const W=320,H=180;
const world=document.createElement("canvas");
world.width=W;world.height=H;
const g=world.getContext("2d");

//========== TIME
let last=performance.now(),time=0;

//========== INPUT
const keys={};
let mouse={x:0,y:0,down:false};
onkeydown=e=>keys[e.key.toLowerCase()]=1;
onkeyup=e=>keys[e.key.toLowerCase()]=0;

canvas.onmousemove=e=>{
const r=canvas.getBoundingClientRect();
mouse.x=(e.clientX-r.left)/r.width*W;
mouse.y=(e.clientY-r.top)/r.height*H;
};
canvas.onmousedown=()=>mouse.down=true;
onmouseup=()=>mouse.down=false;

//========== FX
let shake=0,zoom=1,hitstop=0,flash=0;

//========== PLAYER
const p={
x:W/2,y:H/2,vx:0,vy:0,
hp:100,
dash:0,
shoot:0,
melee:0,
slot:0,
combo:0,
comboTimer:0,
score:0,
high:localStorage.hi||0
};

//========== WEAPONS
const guns=[
{rate:6,dmg:36,spd:260,col:"#00ffd5"},
{rate:12,dmg:18,spd:320,col:"#7CFF6B"},
{rate:1.6,dmg:18,spd:240,pel:8,col:"#ff3b6b"}
];

//========== OBJECT POOLS
const bullets=[];
const enemies=[];
const sparks=[];
const floats=[];

//========== UTILS
const rand=(a,b)=>a+Math.random()*(b-a);
const dist=(a,b)=>((a.x-b.x)**2+(a.y-b.y)**2);

//========== PARTICLES
function spark(x,y,c,n=6){
for(let i=0;i<n;i++)
sparks.push({x,y,vx:rand(-160,160),vy:rand(-160,160),t:.6,c});
}

//========== ENEMY TYPES
function enemy(type){
const e={x:rand(0,W),y:-10,vx:0,vy:0,type};

if(type==="runner"){e.hp=40;e.spd=70;e.col="#ff5e5e";}
else if(type==="tank"){e.hp=240;e.spd=18;e.col="#9b6bff";}
else if(type==="boom"){e.hp=60;e.spd=30;e.col="#ffb347";e.boom=1;}
else if(type==="boss"){e.hp=1200;e.spd=22;e.col="#ff2f92";e.boss=1;}
else{e.hp=80;e.spd=32;e.col="#58b0ff";}
return e;
}

//========== WAVE
let wave=1,spawnTimer=2;

function spawnWave(){
for(let i=0;i<wave+2;i++){
let r=Math.random();
if(wave%5===0 && i===0) enemies.push(enemy("boss"));
else if(r<.15) enemies.push(enemy("tank"));
else if(r<.35) enemies.push(enemy("runner"));
else if(r<.5) enemies.push(enemy("boom"));
else enemies.push(enemy());
}
}

//========== SHOOT
function shoot(){
const w=guns[p.slot];
if(p.shoot>0)return;
p.shoot=1/w.rate;

let ang=Math.atan2(mouse.y-p.y,mouse.x-p.x);

for(let i=0;i<(w.pel||1);i++){
let a=ang+rand(-.2,.2);
bullets.push({x:p.x,y:p.y,vx:Math.cos(a)*w.spd,vy:Math.sin(a)*w.spd,d:w.dmg,c:w.col});
}
shake=5;
}

//========== DASH
function dash(){
if(p.dash>0)return;
p.dash=1.2;
let a=Math.atan2(mouse.y-p.y,mouse.x-p.x);
p.vx=Math.cos(a)*320;
p.vy=Math.sin(a)*320;
spark(p.x,p.y,"#b300ff",30);
shake=12;
}

//========== UPDATE
function update(dt){

if(hitstop>0){hitstop-=dt;return}

// movement
let mx=(keys.d?1:0)-(keys.a?1:0);
let my=(keys.s?1:0)-(keys.w?1:0);
let l=Math.hypot(mx,my)||1;
mx/=l;my/=l;

p.vx+=mx*160*dt;
p.vy+=my*160*dt;
p.vx*=0.8;p.vy*=0.8;
p.x+=p.vx*dt;
p.y+=p.vy*dt;

p.x=Math.max(10,Math.min(W-10,p.x));
p.y=Math.max(10,Math.min(H-10,p.y));

// dash
if(keys.shift) dash();
p.dash-=dt;

// shoot
if(mouse.down) shoot();
p.shoot-=dt;

// punch
if(keys[" "]&&p.melee<=0){
p.melee=.4;
for(const e of enemies){
if(dist(e,p)<500){
e.hp-=50;
e.vx+=rand(-100,100);
e.vy+=rand(-100,100);
spark(e.x,e.y,"#fff",14);
p.combo++;
p.comboTimer=2;
hitstop=.03;
}
}
shake=10;
}
p.melee-=dt;

// combo decay
p.comboTimer-=dt;
if(p.comboTimer<=0)p.combo=0;

// swap
if(keys["1"])p.slot=0;
if(keys["2"])p.slot=1;
if(keys["3"])p.slot=2;

// bullets
for(let i=bullets.length-1;i>=0;i--){
let b=bullets[i];
b.x+=b.vx*dt;
b.y+=b.vy*dt;
if(b.x<0||b.y<0||b.x>W||b.y>H){bullets.splice(i,1);continue;}

for(const e of enemies){
if(dist(e,b)<64){
e.hp-=b.d*(1+p.combo*.1);
spark(b.x,b.y,b.c,10);
bullets.splice(i,1);
p.combo++;
p.comboTimer=2;
hitstop=.02;
break;
}
}
}

// enemies
for(let i=enemies.length-1;i>=0;i--){
let e=enemies[i];
let a=Math.atan2(p.y-e.y,p.x-e.x);
e.x+=Math.cos(a)*e.spd*dt;
e.y+=Math.sin(a)*e.spd*dt;

if(dist(e,p)<90){
p.hp-=28*dt;
flash=.2;
}

if(e.hp<=0){
if(e.boom){
spark(e.x,e.y,"#ffb347",50);
for(const o of enemies) if(dist(o,e)<1600) o.hp-=40;
}
p.score+=10*wave*(1+p.combo*.2);
enemies.splice(i,1);
}
}

// waves
if(enemies.length===0){
spawnTimer-=dt;
if(spawnTimer<=0){
wave++;
spawnTimer=3;
spawnWave();
}
}

// death
if(p.hp<=0){
if(p.score>p.high){p.high=p.score;localStorage.hi=p.high;}
wave=1;p.hp=100;p.score=0;
enemies.length=0;
spawnWave();
}
}

//========== DRAW
function draw(){

// disco floor
for(let x=0;x<W;x+=16)
for(let y=0;y<H;y+=16){
g.fillStyle=`hsl(${(x*y+time*120)%360}70%12%)`;
g.fillRect(x,y,16,16);
}

// arena glow border
g.strokeStyle=`hsl(${time*200%360}80%40%)`;
g.strokeRect(0,0,W,H);

// bullets
for(const b of bullets){
g.fillStyle=b.c;
g.fillRect(b.x,b.y,2,2);
}

// enemies
for(const e of enemies){
g.fillStyle=e.col;
g.fillRect(e.x-5,e.y-5,10,10);
if(e.boss){
g.strokeStyle="#fff";
g.strokeRect(e.x-7,e.y-7,14,14);
}
}

// player
g.fillStyle="#b300ff";
g.fillRect(p.x-6,p.y-6,12,12);

// sparks
for(let i=sparks.length-1;i>=0;i--){
let s=sparks[i];
s.x+=s.vx*.016;
s.y+=s.vy*.016;
s.t-=.016;
g.fillStyle=s.c;
g.fillRect(s.x,s.y,1,1);
if(s.t<=0)sparks.splice(i,1);
}

// UI
g.fillStyle="#111";
g.fillRect(8,8,100,8);
g.fillStyle="#7CFF6B";
g.fillRect(8,8,p.hp,8);

g.fillStyle="#fff";
g.fillText("WAVE "+wave,120,14);
g.fillText("COMBO "+p.combo,200,14);
g.fillText("SCORE "+Math.floor(p.score),8,170);
g.fillText("HI "+Math.floor(p.high),200,170);

// flash overlay
if(flash>0){
g.fillStyle="rgba(255,0,0,"+flash+")";
g.fillRect(0,0,W,H);
flash*=.9;
}

// upscale
ctx.save();
ctx.imageSmoothingEnabled=false;
ctx.drawImage(world,(Math.random()-.5)*shake,(Math.random()-.5)*shake,canvas.width*zoom,canvas.height*zoom);
ctx.restore();

shake*=.9;
zoom+=((1)-zoom)*.1;
}

//========== LOOP
function loop(n){
let dt=(n-last)/1000;
last=n;
time+=dt;
update(dt);
draw();
requestAnimationFrame(loop);
}

spawnWave();
requestAnimationFrame(loop);

})();
</script>
</body>
</html>
