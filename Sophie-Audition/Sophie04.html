<!-- Sophie04.html (KITCHEN + DANCE FLOOR / FRIDGE PUKE + RECORD PLAYER + DOG/CAT APPEAR) -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SOPHIE / AUDITION ‚Äî Kitchen (Sophie04)</title>
  <meta name="theme-color" content="#07060a" />
  <style>
    :root{
      --ink:#f2f2ff;
      --muted:rgba(242,242,255,.72);
      --hair:rgba(255,255,255,.10);
      --violet:#8A2EFF;
      --ok:#7CFF6B;
      --danger:#ff3b6b;
    }
    html,body{height:100%;margin:0;background:radial-gradient(900px 650px at 55% 35%, #121a24 0%, #07060a 55%, #05040a 100%);overflow:hidden;font-family:ui-monospace, Menlo, Consolas, monospace;color:var(--ink)}
    canvas{position:fixed;inset:0;display:block}
    .hud{position:fixed;left:14px;top:12px;z-index:10;display:flex;gap:10px;flex-wrap:wrap;user-select:none}
    .pill{border:1px solid var(--hair);background:rgba(0,0,0,.35);backdrop-filter: blur(8px);border-radius:999px;padding:8px 10px;font-size:12px;letter-spacing:.12em;text-transform:uppercase;display:flex;gap:10px;align-items:center;box-shadow:0 0 20px rgba(138,46,255,.14)}
    .dot{width:8px;height:8px;border-radius:50%;background:var(--violet);box-shadow:0 0 14px rgba(138,46,255,.9)}
    .tip{position:fixed;right:14px;top:12px;z-index:10;width:min(480px, calc(100vw - 28px));border:1px solid var(--hair);background:rgba(0,0,0,.35);backdrop-filter: blur(8px);border-radius:16px;padding:10px 12px;font-size:12px;color:var(--muted)}
    .centerToast{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:20;pointer-events:none;opacity:0;transition:.25s;border:1px solid var(--hair);background:rgba(0,0,0,.45);backdrop-filter: blur(10px);border-radius:18px;padding:12px 14px;max-width:min(560px, calc(100vw - 36px));text-align:center;line-height:1.35;box-shadow:0 0 36px rgba(138,46,255,.12)}
    .centerToast.show{opacity:1}
    .kbd{display:inline-block;padding:2px 6px;border-radius:8px;border:1px solid var(--hair);background:rgba(255,255,255,.06);color:var(--ink);font-size:11px}
  </style>
</head>
<body>
<canvas id="c"></canvas>

<div class="hud">
  <div class="pill"><span class="dot"></span><b>SOPHIE04</b><span>KITCHEN</span></div>
  <div class="pill">Dance Floor: <span id="danceState">IDLE</span></div>
</div>

<div class="tip" id="tip">
  <b>Kitchen</b> is a little nightclub disguised as a home. Stand on the dance floor long enough and the pets join.
  <div style="margin-top:6px">
    Interact <span class="kbd">E</span> ¬∑ Dance toggle <span class="kbd">Z</span> ¬∑ Back door ‚Üí Living Room
    <br/>Try: Sink (wash), Blender (margarita brings Lucas), Record Player, Fridge (‚Ä¶don‚Äôt)
    <br/>Hide tips <span class="kbd">H</span>
  </div>
</div>

<div class="centerToast" id="toast"></div>

<script>
(() => {
  const STORE_KEY="SOPHIA_AUDITION_SAVE_V1";
  const defaultSave={ outfit:"violet", hasFrontDoorKey:false, lastRoom:"Sophie04.html" };
  const loadSave=()=>{ try{ const raw=localStorage.getItem(STORE_KEY); return raw?{...defaultSave,...JSON.parse(raw)}:{...defaultSave}; }catch(e){ return {...defaultSave}; } };
  const save=loadSave();
  const toast=document.getElementById("toast");
  const tip=document.getElementById("tip");
  const danceState=document.getElementById("danceState");
  function commitSave(){ save.lastRoom="Sophie04.html"; localStorage.setItem(STORE_KEY, JSON.stringify(save)); }
  function showToast(html, ms=1400){ toast.innerHTML=html; toast.classList.add("show"); clearTimeout(showToast._t); showToast._t=setTimeout(()=>toast.classList.remove("show"), ms); }
  function go(href){ commitSave(); location.href=href; }

  const canvas=document.getElementById("c");
  const ctx=canvas.getContext("2d");
  const DPR=Math.min(2, devicePixelRatio||1);
  function resize(){ canvas.width=Math.floor(innerWidth*DPR); canvas.height=Math.floor(innerHeight*DPR); canvas.style.width=innerWidth+"px"; canvas.style.height=innerHeight+"px"; ctx.setTransform(DPR,0,0,DPR,0,0); }
  addEventListener("resize", resize, {passive:true}); resize();

  const keys=new Set();
  addEventListener("keydown",(e)=>{
    const k=e.key.toLowerCase(); keys.add(k);
    if(["arrowup","arrowdown","arrowleft","arrowright"," "].includes(e.key)) e.preventDefault();
    if(k==="h") tip.style.display=(tip.style.display==="none")?"":"none";
    if(k==="z") player.dancing=!player.dancing;
    if(k==="x") player.splitsT=0.6;
    if(e.key===" ") player.jumpT=Math.max(player.jumpT,0.35);
    if(k==="e") tryInteract();
  },{passive:false});
  addEventListener("keyup",(e)=>keys.delete(e.key.toLowerCase()),{passive:true});
  const down=(k)=>keys.has(k);
  const axis=()=>{
    const left=down("a")||down("arrowleft");
    const right=down("d")||down("arrowright");
    const up=down("w")||down("arrowup");
    const dn=down("s")||down("arrowdown");
    return {x:(right?1:0)-(left?1:0), y:(dn?1:0)-(up?1:0)};
  };

  const world={
    w: 1300,
    h: 860,
    solids:[
      {x: 120, y: 160, w: 250, h: 140, label:"Sink", action: washHands},
      {x: 420, y: 160, w: 250, h: 140, label:"Blender", action: blendMargarita},
      {x: 980, y: 160, w: 240, h: 160, label:"Fridge", action: fridgePuke},
      {x: 980, y: 560, w: 240, h: 140, label:"Record Player", action: ()=>go("recordplayer.html")},
      // counters block
      {x: 120, y: 330, w: 1100, h: 90},
    ],
    doors:[
      {x: 60, y: 620, w: 140, h: 160, label:"To Living Room", hint:"Sophie03.html", action: ()=>go("Sophie03.html")}
    ],
    zones:[
      {x: 380, y: 470, w: 520, h: 300, label:"Dance Floor"}
    ]
  };

  const player={ x: 520, y: 620, r: 18, vx:0, vy:0, facing:{x:1,y:0}, dancing:false, jumpT:0, splitsT:0 };
  const milo={ x: player.x-40, y: player.y+30, r: 14, purr:0 };

  // extra pets (appear if you stand on dance floor long enough)
  const pets={
    blackDog: {active:false, x: 780, y: 720, r: 16, t:0},
    otherCat: {active:false, x: 540, y: 760, r: 13, t:0},
    lucas: {active:false, x: 680, y: 560, r: 18, t:0},
  };

  const cam={x:0,y:0};
  const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
  function collideCircleRect(cx,cy,cr, rx,ry,rw,rh){
    const px=clamp(cx,rx,rx+rw), py=clamp(cy,ry,ry+rh);
    const dx=cx-px, dy=cy-py;
    return (dx*dx+dy*dy) < cr*cr;
  }
  function resolveSolids(ent){
    ent.x=clamp(ent.x, ent.r, world.w-ent.r);
    ent.y=clamp(ent.y, ent.r, world.h-ent.r);
    for(const s of world.solids){
      if(collideCircleRect(ent.x,ent.y,ent.r, s.x,s.y,s.w,s.h)){
        const left=ent.x-s.x, right=(s.x+s.w)-ent.x, top=ent.y-s.y, bottom=(s.y+s.h)-ent.y;
        const minX=Math.min(left,right), minY=Math.min(top,bottom);
        if(minX<minY) ent.x += (left<right)?-(ent.r):(ent.r);
        else ent.y += (top<bottom)?-(ent.r):(ent.r);
        ent.x=clamp(ent.x, ent.r, world.w-ent.r);
        ent.y=clamp(ent.y, ent.r, world.h-ent.r);
      }
    }
  }
  function updateCam(){
    const tx=player.x-innerWidth/2, ty=player.y-innerHeight/2;
    cam.x += (tx-cam.x)*0.08; cam.y += (ty-cam.y)*0.08;
    cam.x=clamp(cam.x,0,world.w-innerWidth);
    cam.y=clamp(cam.y,0,world.h-innerHeight);
  }

  function nearestInteract(){
    let best=null;
    const consider=(label,action,hint,cx,cy)=>{
      const d=Math.hypot(player.x-cx, player.y-cy);
      if(d<92 && (!best||d<best.d)) best={d,label,action,hint,cx,cy};
    };
    for(const d of world.doors) consider(d.label,d.action,d.hint, d.x+d.w/2, d.y+d.h/2);
    for(const s of world.solids) if(s.label && s.action) consider(s.label,s.action,null, s.x+s.w/2, s.y+s.h/2);
    return best;
  }
  function tryInteract(){
    const n=nearestInteract();
    if(!n){ showToast("Nothing to interact with.", 800); return; }
    if(n.hint) showToast(`<b>${n.label}</b><br><span style="opacity:.8">Entering: ${n.hint}</span>`, 700);
    else showToast(`<b>${n.label}</b>`, 520);
    setTimeout(()=>n.action(),120);
  }

  // ========= Kitchen actions =========
  let pukeT = 0;
  let screenShake = 0;
  function washHands(){
    showToast(`You wash your hands. The sink hums approval. ü´ß`, 1200);
  }
  function blendMargarita(){
    showToast(`Blending‚Ä¶ üçã‚Äçüü©<br>Lucas hears it like a signal flare.`, 1500);
    pets.lucas.active = true;
    pets.lucas.t = 0;
  }
  function fridgePuke(){
    pukeT = Math.max(pukeT, 2.2);
    screenShake = Math.max(screenShake, 1.0);
    showToast(`<b>Bad idea.</b><br>The fridge air is‚Ä¶ wrong. You puke. ü§¢`, 1500);
  }

  function outfitColor(name){
    switch(name){
      case "blue": return "#4aa6ff";
      case "red": return "#ff4a6b";
      case "green": return "#53ff86";
      case "black": return "#1a1a22";
      default: return "#8A2EFF";
    }
  }

  function onDanceFloor(){
    const z = world.zones[0];
    return (player.x > z.x && player.x < z.x+z.w && player.y > z.y && player.y < z.y+z.h);
  }

  let danceHold = 0;

  // ========= Render =========
  function drawFloor(){
    ctx.fillStyle="#07060a";
    ctx.fillRect(0,0,world.w,world.h);

    // kitchen tiles
    for(let y=0;y<world.h;y+=44){
      for(let x=0;x<world.w;x+=44){
        const a = ((x+y)/44)%2===0 ? 0.06 : 0.035;
        ctx.fillStyle=`rgba(255,255,255,${a})`;
        ctx.fillRect(x,y,42,42);
      }
    }

    // vignette
    const g=ctx.createRadialGradient(world.w/2,world.h/2,160, world.w/2,world.h/2, 980);
    g.addColorStop(0,"rgba(0,0,0,0)");
    g.addColorStop(1,"rgba(0,0,0,.62)");
    ctx.fillStyle=g;
    ctx.fillRect(0,0,world.w,world.h);
  }

  function drawZone(z){
    // dance floor glow grid
    ctx.fillStyle="rgba(138,46,255,.08)";
    ctx.fillRect(z.x,z.y,z.w,z.h);
    for(let y=z.y;y<z.y+z.h;y+=34){
      ctx.fillStyle="rgba(255,255,255,.04)";
      ctx.fillRect(z.x, y, z.w, 2);
    }
    for(let x=z.x;x<z.x+z.w;x+=34){
      ctx.fillStyle="rgba(255,255,255,.03)";
      ctx.fillRect(x, z.y, 2, z.h);
    }
    const g=ctx.createRadialGradient(z.x+z.w/2,z.y+z.h/2,30, z.x+z.w/2,z.y+z.h/2, 420);
    g.addColorStop(0,"rgba(0,255,210,.10)");
    g.addColorStop(1,"rgba(0,0,0,0)");
    ctx.fillStyle=g;
    ctx.fillRect(z.x-120,z.y-120,z.w+240,z.h+240);
  }

  function drawFurniture(x,y,w,h,tint){
    ctx.fillStyle="rgba(0,0,0,.35)";
    ctx.fillRect(x+10,y+10,w,h);
    ctx.fillStyle=tint;
    ctx.fillRect(x,y,w,h);
    ctx.fillStyle="rgba(255,255,255,.06)";
    ctx.fillRect(x,y,w,10);
    ctx.strokeStyle="rgba(255,255,255,.14)";
    ctx.lineWidth=2;
    ctx.strokeRect(x,y,w,h);
  }

  function drawDoor(d){
    ctx.fillStyle="rgba(138,46,255,.10)";
    ctx.fillRect(d.x,d.y,d.w,d.h);
    ctx.strokeStyle="rgba(255,255,255,.18)";
    ctx.lineWidth=2;
    ctx.strokeRect(d.x,d.y,d.w,d.h);
    const g=ctx.createRadialGradient(d.x+d.w/2,d.y+d.h/2,10, d.x+d.w/2,d.y+d.h/2,120);
    g.addColorStop(0,"rgba(138,46,255,.20)");
    g.addColorStop(1,"rgba(0,0,0,0)");
    ctx.fillStyle=g;
    ctx.fillRect(d.x-80,d.y-80,d.w+160,d.h+160);
  }

  function drawCharacter(){
    const col=outfitColor(save.outfit);
    const bob=player.dancing?Math.sin(tt*10)*3:0;
    const jump=player.jumpT>0?Math.sin((1-player.jumpT)*Math.PI)*12:0;
    const splits=player.splitsT>0?(1-player.splitsT/0.6):0;
    const x=player.x, y=player.y - jump + bob;

    ctx.fillStyle="rgba(0,0,0,.35)";
    ctx.beginPath(); ctx.ellipse(x, player.y+10, 18, 9, 0, 0, Math.PI*2); ctx.fill();

    const aura=ctx.createRadialGradient(x,y-22,6, x,y-22, 40);
    aura.addColorStop(0,"rgba(180,140,255,.20)");
    aura.addColorStop(1,"rgba(0,0,0,0)");
    ctx.fillStyle=aura; ctx.beginPath(); ctx.arc(x,y-18,40,0,Math.PI*2); ctx.fill();

    ctx.fillStyle="rgba(255,245,235,.95)";
    ctx.beginPath(); ctx.arc(x,y-18,12,0,Math.PI*2); ctx.fill();

    ctx.fillStyle="rgba(20,20,30,.85)";
    ctx.beginPath(); ctx.arc(x,y-22,14,0,Math.PI*2); ctx.fill();

    ctx.fillStyle=col;
    ctx.beginPath(); ctx.moveTo(x,y-6); ctx.lineTo(x-14,y+16); ctx.lineTo(x+14,y+16); ctx.closePath(); ctx.fill();

    ctx.strokeStyle="rgba(255,245,235,.85)";
    ctx.lineWidth=4; ctx.lineCap="round";
    ctx.beginPath();
    if(splits>0){
      ctx.moveTo(x,y+16); ctx.lineTo(x-18-10*splits,y+24);
      ctx.moveTo(x,y+16); ctx.lineTo(x+18+10*splits,y+24);
    }else{
      ctx.moveTo(x-4,y+16); ctx.lineTo(x-6,y+26);
      ctx.moveTo(x+4,y+16); ctx.lineTo(x+6,y+26);
    }
    ctx.stroke();

    if(player.dancing){
      for(let i=0;i<2;i++){
        const sx=x+Math.sin(tt*7+i*2.2)*22;
        const sy=y-24+Math.cos(tt*8+i*3.1)*18;
        ctx.fillStyle="rgba(255,255,255,.55)";
        ctx.fillRect(sx,sy,2,2);
      }
    }
  }

  function drawMilo(){
    milo.purr += 0.02;
    const tail=Math.sin(milo.purr*4)*6;

    ctx.fillStyle="rgba(0,0,0,.28)";
    ctx.beginPath(); ctx.ellipse(milo.x,milo.y+8,14,7,0,0,Math.PI*2); ctx.fill();

    ctx.fillStyle="rgba(255,255,255,.90)";
    ctx.beginPath(); ctx.ellipse(milo.x,milo.y,12,9,0,0,Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(milo.x+10,milo.y-6,7,0,Math.PI*2); ctx.fill();

    ctx.beginPath();
    ctx.moveTo(milo.x+6,milo.y-11); ctx.lineTo(milo.x+10,milo.y-18); ctx.lineTo(milo.x+14,milo.y-11);
    ctx.closePath(); ctx.fill();

    ctx.strokeStyle="rgba(255,255,255,.85)";
    ctx.lineWidth=4; ctx.lineCap="round";
    ctx.beginPath();
    ctx.moveTo(milo.x-10,milo.y+2);
    ctx.quadraticCurveTo(milo.x-24,milo.y-6, milo.x-16,milo.y-16+tail);
    ctx.stroke();

    ctx.fillStyle="rgba(30,30,40,.55)";
    ctx.fillRect(milo.x+12,milo.y-8,2,2);
  }

  function drawPetDog(p){
    p.t += 0.02;
    const wag=Math.sin(p.t*4)*6;
    ctx.fillStyle="rgba(0,0,0,.30)";
    ctx.beginPath(); ctx.ellipse(p.x,p.y+10,16,7,0,0,Math.PI*2); ctx.fill();

    ctx.fillStyle="rgba(20,20,26,.92)";
    ctx.beginPath(); ctx.ellipse(p.x,p.y,14,10,0,0,Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(p.x+12,p.y-6,7,0,Math.PI*2); ctx.fill();

    ctx.strokeStyle="rgba(20,20,26,.92)";
    ctx.lineWidth=4; ctx.lineCap="round";
    ctx.beginPath();
    ctx.moveTo(p.x-12,p.y+2);
    ctx.quadraticCurveTo(p.x-24,p.y-8, p.x-14,p.y-18+wag);
    ctx.stroke();
  }

  function drawOtherCat(p){
    p.t += 0.02;
    const tail=Math.sin(p.t*4)*6;
    ctx.fillStyle="rgba(0,0,0,.22)";
    ctx.beginPath(); ctx.ellipse(p.x,p.y+8,13,6,0,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="rgba(255,255,255,.78)";
    ctx.beginPath(); ctx.ellipse(p.x,p.y,11,8,0,0,Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(p.x+10,p.y-6,6,0,Math.PI*2); ctx.fill();
    ctx.strokeStyle="rgba(255,255,255,.78)";
    ctx.lineWidth=4; ctx.lineCap="round";
    ctx.beginPath();
    ctx.moveTo(p.x-10,p.y+2);
    ctx.quadraticCurveTo(p.x-22,p.y-6, p.x-14,p.y-16+tail);
    ctx.stroke();
  }

  function drawLucas(p){
    p.t += 0.02;
    const bob=Math.sin(p.t*3)*2;
    ctx.fillStyle="rgba(0,0,0,.30)";
    ctx.beginPath(); ctx.ellipse(p.x,p.y+12,18,8,0,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="rgba(255,255,255,.10)";
    ctx.beginPath(); ctx.arc(p.x,p.y-12+bob,14,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="rgba(255,255,255,.22)";
    ctx.font="11px ui-monospace, Menlo, monospace";
    ctx.fillText("LUCAS", p.x-18, p.y-30);
  }

  function roundRect(x,y,w,h,r){
    const rr=Math.min(r,w/2,h/2);
    ctx.moveTo(x+rr,y);
    ctx.arcTo(x+w,y,x+w,y+h,rr);
    ctx.arcTo(x+w,y+h,x,y+h,rr);
    ctx.arcTo(x,y+h,x,y,rr);
    ctx.arcTo(x,y,x+w,y,rr);
    ctx.closePath();
  }

  function render(){
    ctx.clearRect(0,0,innerWidth,innerHeight);

    const shake = screenShake>0 ? (Math.sin(tt*80)*screenShake*6) : 0;

    ctx.save();
    ctx.translate(-cam.x + shake, -cam.y - shake);

    drawFloor();
    drawZone(world.zones[0]);

    for(const s of world.solids){
      let tint="rgba(255,255,255,.06)";
      if(s.label==="Sink") tint="rgba(160,210,255,.06)";
      if(s.label==="Blender") tint="rgba(255,230,180,.05)";
      if(s.label==="Fridge") tint="rgba(255,59,107,.05)";
      if(s.label==="Record Player") tint="rgba(138,46,255,.06)";
      drawFurniture(s.x,s.y,s.w,s.h,tint);
      ctx.fillStyle="rgba(255,255,255,.22)";
      ctx.font="11px ui-monospace, Menlo, monospace";
      ctx.fillText(s.label, s.x+10, s.y+18);
    }

    for(const d of world.doors){
      drawDoor(d);
      ctx.fillStyle="rgba(255,255,255,.22)";
      ctx.font="11px ui-monospace, Menlo, monospace";
      ctx.fillText("DOOR", d.x+10, d.y+18);
    }

    // pets
    if(pets.lucas.active) drawLucas(pets.lucas);
    if(pets.blackDog.active) drawPetDog(pets.blackDog);
    if(pets.otherCat.active) drawOtherCat(pets.otherCat);

    drawMilo();
    drawCharacter();

    // Interact prompt
    const n=nearestInteract();
    if(n){
      ctx.strokeStyle="rgba(138,46,255,.45)";
      ctx.lineWidth=2;
      ctx.beginPath(); ctx.ellipse(player.x,player.y+8,28,14,0,0,Math.PI*2); ctx.stroke();

      const text=`E ¬∑ ${n.label}`;
      ctx.font="12px ui-monospace, Menlo, monospace";
      const m=ctx.measureText(text);
      const px=player.x - m.width/2 - 10;
      const py=player.y - 44;
      ctx.fillStyle="rgba(0,0,0,.45)";
      ctx.strokeStyle="rgba(255,255,255,.14)";
      ctx.lineWidth=1;
      ctx.beginPath(); roundRect(px,py,m.width+20,22,10); ctx.fill(); ctx.stroke();
      ctx.fillStyle="rgba(255,255,255,.88)";
      ctx.fillText(text, player.x - m.width/2, py+15);
    }

    // puke overlay
    if(pukeT>0){
      const a = 0.12 + 0.12*Math.sin(tt*10);
      ctx.globalAlpha = a;
      ctx.fillStyle = "rgba(255,59,107,1)";
      ctx.fillRect(0,0,world.w,world.h);
      ctx.globalAlpha = 0.12;
      ctx.fillStyle = "rgba(0,255,210,1)";
      ctx.fillRect(0,0,world.w,world.h);
      ctx.globalAlpha = 1;
    }

    ctx.restore();
  }

  // ========= Loop =========
  let last=performance.now();
  let tt=0;
  function step(now){
    const dt=Math.min(0.033,(now-last)/1000);
    last=now; tt+=dt;

    const a=axis();
    let sp=(down("shift")?220:150);
    if(player.dancing) sp*=0.65;

    const mag=Math.hypot(a.x,a.y)||1;
    const ax=a.x/mag, ay=a.y/mag;

    player.vx += (ax*sp - player.vx)*0.18;
    player.vy += (ay*sp - player.vy)*0.18;
    player.x += player.vx*dt; player.y += player.vy*dt;

    if(Math.abs(ax)+Math.abs(ay)>0.01){ player.facing.x=ax; player.facing.y=ay; }

    resolveSolids(player);

    const followDist=46;
    const tx=player.x - player.facing.x*followDist - 18;
    const ty=player.y - player.facing.y*followDist + 14;
    milo.x += (tx-milo.x)*0.08;
    milo.y += (ty-milo.y)*0.08;
    resolveSolids(milo);

    player.jumpT=Math.max(0,player.jumpT-dt);
    player.splitsT=Math.max(0,player.splitsT-dt);

    // Dance floor logic
    const on = onDanceFloor();
    if(on){
      danceHold += dt;
      danceState.textContent = player.dancing ? "DANCING" : "STANDING";
      // if you stand long enough, pets show up
      if(danceHold > 2.8){
        pets.blackDog.active = true;
        pets.otherCat.active = true;
      }
    }else{
      danceHold = Math.max(0, danceHold - dt*1.5);
      danceState.textContent = "IDLE";
      if(danceHold <= 0.1){
        pets.blackDog.active = false;
        pets.otherCat.active = false;
      }
    }

    // effects
    pukeT = Math.max(0, pukeT - dt);
    screenShake = Math.max(0, screenShake - dt*1.5);

    updateCam();
    render();
    requestAnimationFrame(step);
  }

  commitSave();
  showToast(`A kitchen that thinks it‚Äôs a club.`, 1400);
  requestAnimationFrame(step);
})();
</script>
</body>
</html>
